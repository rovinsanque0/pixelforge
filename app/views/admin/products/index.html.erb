<h1>Manage Products</h1>

<%= link_to "New Product", new_admin_product_path %>

<table>
  <tr>
    <th>Name</th>
    <th>Price</th>
    <th>Stock</th>
    <th>Category</th>
    <th>Actions</th>
  </tr>

  <% @products.each do |product| %>
    <tr>
      <td><%= product.name %></td>

      <!-- FIXED PRICE DISPLAY -->
      <td>
        <% if product.on_sale? && product.sale_price.present? %>
          <span style="text-decoration: line-through; color: gray;">
            <%= number_to_currency(product.original_price) %>
          </span>
          <span style="color: red; font-weight: bold;">
            <%= number_to_currency(product.sale_price) %>
          </span>
        <% else %>
          <%= number_to_currency(product.original_price) %>
        <% end %>
      </td>

      <td><%= product.stock %></td>
      <td><%= product.category&.name %></td>
      <td>
        <%= link_to "Edit", edit_admin_product_path(product) %> |
        <%= link_to "Delete", admin_product_path(product),
                    data: { turbo_method: :delete, turbo_confirm: "Are you sure?" } %>
      </td>
    </tr>
  <% end %>
</table>
