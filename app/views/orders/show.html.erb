<h1 class="mb-4">Order Confirmation</h1>

<div class="card mb-4">
  <div class="card-body">
    <h4 class="card-title">Order #<%= @order.id %></h4>
    <p class="mb-1"><strong>Status:</strong> <%= @order.status.capitalize %></p>
    <p class="mb-1"><strong>Order Date:</strong> <%= @order.created_at.strftime("%B %d, %Y %I:%M %p") %></p>
  </div>
</div>

<h3>Shipping Information</h3>
<div class="card mb-4">
  <div class="card-body">
    <p><strong>Address:</strong> <%= @order.address %></p>
    <p><strong>City:</strong> <%= @order.city %></p>
    <p><strong>Postal Code:</strong> <%= @order.postal_code %></p>
    <p><strong>Province:</strong> <%= @order.province.name %></p>
  </div>
</div>

<h3>Items Ordered</h3>
<table class="table table-striped mb-4">
  <thead>
    <tr>
      <th>Product</th>
      <th>Qty</th>
      <th>Price (each)</th>
      <th>Total</th>
    </tr>
  </thead>
  <tbody>
    <% @order.order_items.each do |item| %>
      <tr>
        <td><%= item.product.name %></td>
        <td><%= item.quantity %></td>
        <td><%= number_to_currency(item.price_at_purchase) %></td>
        <td><%= number_to_currency(item.quantity * item.price_at_purchase) %></td>
      </tr>
    <% end %>
  </tbody>
</table>

<h3>Taxes & Totals</h3>
<table class="table">
  <tbody>
    <tr>
      <th>Subtotal</th>
      <td><%= number_to_currency(@order.subtotal) %></td>
    </tr>
    <tr>
      <th>GST</th>
      <td><%= number_to_currency(@order.gst_amount) %></td>
    </tr>
    <tr>
      <th>PST</th>
      <td><%= number_to_currency(@order.pst_amount) %></td>
    </tr>
    <tr>
      <th>HST</th>
      <td><%= number_to_currency(@order.hst_amount) %></td>
    </tr>
    <tr class="table-primary">
      <th>Total</th>
      <td><strong><%= number_to_currency(@order.total) %></strong></td>
    </tr>
  </tbody>
</table>

<% if @order.stripe_payment_id.present? %>
  <p><strong>Payment ID:</strong> <%= @order.stripe_payment_id %></p>
<% end %>

<%= link_to "Back to Products", products_path, class: "btn btn-secondary mt-4" %>
